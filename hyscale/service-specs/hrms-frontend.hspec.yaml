name: hrms-frontend
depends: 
      - hrdatabase
image:
   buildSpec:
     stackImage: tomcat-image:8.5.15 #specify the stackImage and StackImage version taken from platform in image:version format
     update: 1   #specify update version of stack-image
     artifacts: 
         - name: HRScaffold_war
           source:
              store: JFrog  # artifact store name from the platform
              repository: "HRScaffold"
              path: "${BUILD_NUM}/HRScaffold.war"
           destination: /usr/local/tomcat/webapps/ROOT.war
replicas: 1 
memory: 2048
ports:
     - port: 8080
       healthCheck:
         httpPath: /
       external: true
volumes:
  - name: logs
    path: /usr/local/tomcat/logs
    size: 1 
    readOnly: false
    storageClass: "standard" # storage class name from the cluster to use for pvc procurement
props:
    - key: JAVA_HOME
      value: "/usr/local/java"
    - key: TOMCAT_HOME
      value: "/usr/local/content/tomcat"
    - key: COUNTRY
      value: "INDIA"
    - key: REGION
      value: "HYD"
    - key: MAX_NO_OF_THREADS
      value: "10"
    - key: MAX_NO_OF_CONNECTIONS
      value: "10"
    - key: MYSQL_HOST
      value: hrdatabase
    - key: MYSQL_ROOT_PASSWORD
      value: cHJhbWF0aQ==
agents:
    - name: fluentd
      image: fluentd:4.3 # side car image and version in the image:version format from the platform
      props:
      - key: FLUENTD_ARGS
        value: "--no-supervisor -vv"
      - key: "system.input.conf"
        type: FILE
        value: "@@WORKSPACE@@/@@CONFIG_DIR@@/system.input.conf"  # add the full path to this file
      - key: "output.conf"
        type: FILE
        value: "@@WORKSPACE@@/@@CONFIG_DIR@@/output.conf"    # add the full path to this file
      volumes:
      - path: "/mnt/log"
        name: "tomcat-logs" # should be same as the volume name of frontend container

